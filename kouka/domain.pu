@startuml lending_and_return_flow

actor 利用者
actor 事務員
boundary カウンター
control 貸出管理
entity 図書
entity 会員
entity 予約


'--- 貸出フロー ---
利用者 -> カウンター : 本と会員証を持参
事務員 -> カウンター : 操作
カウンター -> 貸出管理 : 貸出処理依頼(本, 会員証)
貸出管理 -> 図書 : 貸出可否確認
貸出管理 -> 会員 : 貸出上限・制約確認
貸出管理 --> カウンター : 貸出処理結果
カウンター --> 利用者 : 本を貸出／不可通知


'--- 返却フロー ---
利用者 -> カウンター : 返却する本を持参
事務員 -> カウンター : 操作
カウンター -> 貸出管理 : 返却処理依頼(本)
貸出管理 -> 図書 : 返却処理
貸出管理 -> 予約 : 予約者確認
貸出管理 -> 会員 : 予約者へ通知（該当時）
貸出管理 --> カウンター : 返却処理結果
カウンター --> 利用者 : 返却完了通知

@enduml